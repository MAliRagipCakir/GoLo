@model CartViewModel

@{
    ViewData["Title"] = "Checkout";
}

<!-- page title -->
<section class="section section--first section--last section--head" data-bg="img/bg.jpg">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section__wrap">
                    <!-- section title -->
                    <h2 class="section__title">Checkout</h2>
                    <!-- end section title -->
                </div>
            </div>
        </div>
    </div>
</section>
<!-- end page title -->
<!-- section -->
<div class="section">
    <div class="container">
        <div class="row">
            <div class="col-12 ">
                <!-- cart -->
                <div class="cart">
                    <form style="width:100%;" method="post" asp-controller="Cart" asp-action="Update">
                        <div class="table-responsive">
                            <table class="cart__table">
                                <thead>
                                    <tr>
                                        <th><a href="#">Product <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.71,10.21,12,7.91l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-3-3a1,1,0,0,0-1.42,0l-3,3a1,1,0,0,0,1.42,1.42Zm4.58,4.58L12,17.09l-2.29-2.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,1.42,0l3-3a1,1,0,0,0-1.42-1.42Z" /></svg></a></th>
                                        <th><a href="#" class="active">Title <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17,13.41,12.71,9.17a1,1,0,0,0-1.42,0L7.05,13.41a1,1,0,0,0,0,1.42,1,1,0,0,0,1.41,0L12,11.29l3.54,3.54a1,1,0,0,0,.7.29,1,1,0,0,0,.71-.29A1,1,0,0,0,17,13.41Z" /></svg></a></th>
                                        <th><a href="#">Platform <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.71,10.21,12,7.91l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-3-3a1,1,0,0,0-1.42,0l-3,3a1,1,0,0,0,1.42,1.42Zm4.58,4.58L12,17.09l-2.29-2.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,1.42,0l3-3a1,1,0,0,0-1.42-1.42Z" /></svg></a></th>
                                        <th><a href="#">Price <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.71,10.21,12,7.91l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-3-3a1,1,0,0,0-1.42,0l-3,3a1,1,0,0,0,1.42,1.42Zm4.58,4.58L12,17.09l-2.29-2.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,1.42,0l3-3a1,1,0,0,0-1.42-1.42Z" /></svg></a></th>
                                        <th style="width:100px"><a href="#">Quantity<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.71,10.21,12,7.91l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-3-3a1,1,0,0,0-1.42,0l-3,3a1,1,0,0,0,1.42,1.42Zm4.58,4.58L12,17.09l-2.29-2.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,1.42,0l3-3a1,1,0,0,0-1.42-1.42Z" /></svg></a></th>
                                        <th><a href="#">Total Price <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.71,10.21,12,7.91l2.29,2.3a1,1,0,0,0,1.42,0,1,1,0,0,0,0-1.42l-3-3a1,1,0,0,0-1.42,0l-3,3a1,1,0,0,0,1.42,1.42Zm4.58,4.58L12,17.09l-2.29-2.3a1,1,0,0,0-1.42,1.42l3,3a1,1,0,0,0,1.42,0l3-3a1,1,0,0,0-1.42-1.42Z" /></svg></a></th>

                                        <th>
                                            <button class="" type="submit">
                                                Update
                                            </button>
                                        </th>
                                    </tr>
                                </thead>

                                <tbody>
                                    @foreach (var item in Model.Items)
                                    {
                                        <tr>
                                            <td>
                                                <div class="cart__img">
                                                    <img src="~/img/games/@item.PictureUri" alt="">
                                                </div>
                                            </td>

                                            <td>
                                                <a asp-controller="Home" asp-action="Details" asp-route-productId="@item.ProductId">@item.GameName</a>
                                            </td>

                                            <td>@item.PlatformName</td>

                                            <td>
                                                <span class="cart__price">@item.UnitPrice.ToString("C2")</span>
                                            </td>

                                            <td>
                                                <input style="width:100px" type="number" name="quantities[@item.ProductId]" value="@item.Quantity" min="1" class="header__input" />
                                            </td>

                                            <td>
                                                <span class="cart__price">@item.SubTotalPrice.ToString("C2")</span>
                                            </td>

                                            <td>
                                                <a data-remove-item="@item.Id" href="#" class="cart__delete" type="button">
                                                    <svg xmlns='http://www.w3.org/2000/svg' width='512' height='512' viewBox='0 0 512 512'><line x1='368' y1='368' x2='144' y2='144' style='fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px' /><line x1='368' y1='144' x2='144' y2='368' style='fill:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px' /></svg>
                                                </a>
                                            </td>
                                        </tr>
                                    }
                                   
                                </tbody>
                            </table>
                        </div>
                    </form>

                    <div class="cart__info">
                        <div class="cart__total">
                            <p> Total:</p>
                            <span>@Model.TotalPrice.ToString("C2")</span>
                        </div>
                        <a href="/Cart/Checkout" type="button" class="form__btn">Complete</a>
                    </div>
                </div>
                <!-- end cart -->
            </div>
        </div>
    </div>
</div>
<!-- end section -->

<form id="frmRemoveItem" asp-controller="Cart" asp-action="RemoveItem">
    <input id="cartItemId" type="hidden" name="cartItemId" />
</form>

@section Scripts{
<script>
    $("[data-remove-item]").click(function (event) {
        event.preventDefault();
        var cartItemId = $(this).data("remove-item");
        $("#cartItemId").val(cartItemId);
        $("#frmRemoveItem").submit();
    });
</script>
}